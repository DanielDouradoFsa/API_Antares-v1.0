<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        table, th, td{
          border: 1pt solid black;
          border-collapse: collapse;
          text-align: left;
          padding: 2pt;
        }
        th{
          background-color: rgb(211, 211, 211);
        }
        table{
          /*margin-top: 30pt;*/
          width: 100%;
        }
        .SectionTitulo{
          text-align: center;
          background: rgb(228, 225, 225);
          font-size: 5mm;
          padding: 10px;
          margin-left: 85pt;
          margin-right: 56pt ;
          /*margin-bottom: 56pt;*/
          font-family: Times;
          /*border: 1px solid rgb(129, 113, 113);*/
        }
        .textSection{
          size: A4;
          text-align: justify;
          font-size: 12pt;
          margin-left: 85pt;
          margin-right: 56pt ;
          /*margin-bottom: 8pt;*/
          line-height: 1.5;
        }

        .margemSuperior{
          margin-top: 30pt;
        }
        .inicioPeriodo{
          font: bold;
        }
        .fimPeriodo{
          font: bold;
        }
        .Escolas{}
        .Agendamentos{}
        .Visitas{}
        .Bolsistas{}
        .Funcionarios{}
    </style>
</head>
<body>
  <!--<div class="margemSuperior">  </div>-->
  <div class="SectionTitulo">Relatório de visitação do Observatório Antares</div>
  <div class="textSection">
    <p STYLE="TEXT-Align:CENTER;">Período de vigência deste relatório: <spam class="inicioPeriodo"></spam> a <spam class="fimPeriodo"></spam>.</p>
  </div>
	<div class ="textSection"> 
    <hr></hr>
    <p>Usuário responsável pela emissão do relatório: %UserEm%.</p>
    <p>Data de emissão do relatório: %DataEm%.</p>
    <p>Horário de emissão do relatório: %HoraEm%.</p>
    <hr></hr>
    <p style="text-align: center;">Conteúdo presente no relatório</p>
    <p class="Agendamentos">• Informações referentes a Agendamentos.</p>
    <p class="Bolsistas">• Informações referentes a Bolsistas.</p>
    <p class="Escolas">• Informações referentes a Escolas. </p>
    <p class="Funcionarios">• Informações referentes a Funcionários.</p>
    <p class="Visitas">• Informações referentes a Visitas.</p>
    <div style="position: absolute; top: 880px;width:75%;"><hr></hr><div style="text-align: center;">Feira de Santana - BA</div><hr></hr></div>
  </div>
  
  
  <!-- Agendamentos -->
  <div class="Agendamentos"><div style="page-break-after: always"></div></div>
  <div class="Agendamentos">
    <div class="SectionTitulo" >Análise dos dados referentes aos Agendamentos</div>
    <div class="textSection">
      <p style="text-indent: 42pt;">        Durante o período relacionado a este relatório, foram registrados %totalAgendamentos% agendamentos. 
        Destes, %quantRealizado% foram concluídos no período; 
        %quantPendente% ainda estão pendentes de confirmação por parte de um funcionário com permissões para tal; 
        %quantCancelado% foram cancelados ou pelo visitante ou por algum funcionário; 
        %quantConfirmado% foram confirmados pelos funcionários mas ainda não foram realizados. 
        <spam id=captionAgendamentosCancelados>A tabela abaixo relaciona os agendamentos que foram cancelados, expirados ou rejeitados no período.</spam>
      </p>
        <table id=AgendamentosCancelados></table>
        <p style="text-indent: 42pt;" id=captionAgendamentosConfirmados>A tabela abaixo relaciona os agendamentos que foram confirmados no período mas que ainda não foram concluídos.</p>
        <table id=AgendamentosConfirmados></table>
        <p style="text-indent: 42pt;" id=captionAgendamentosPendentes>A tabela abaixo relaciona os agendamentos que foram solicitados porém ainda não tiveram confirmação.</p>
        <table id=AgendamentosPendentes></table>
        <p style="text-indent: 42pt;" id=captionAgendamentosRealizados>A tabela abaixo relaciona os agendamentos que foram concluídos no período ao qual este relatório se dirige.</p>
        <table id=AgendamentosRealizados></table>

    </div>
  </div>

  <!-- Página Bolsistas -->
  <div class="Bolsistas"><div style="page-break-after: always"></div></div>
  <div class="Bolsistas">
    <div class="SectionTitulo" >Análise dos dados referentes aos Bolsistas</div>
    <div class="textSection">
      <p style="text-indent: 42pt;"> Na data de emissão deste relatório, há no sistema um total de %quantBolsistas%, dos quais %quantBolsistaInativo% estão inativos e %quantBolsistaAtivo% estão ativos. </p>
      <spam id=captionBolsistasAtivos>A tabela abaixo relaciona os bolsistas ativos.</spam>
      <table id=BolsistasAtivos></table>
    </div>
  </div>

  <!-- Página Escolas -->
  <div class="Escolas"><div style="page-break-after: always"></div></div>
  <div class="Escolas">
    <div class="SectionTitulo" >Análise dos dados referentes às Escolas</div>
    <div class="textSection">
      <p style="text-indent: 42pt;">O sistema possui registro de %quantEscolas% escolas cadastradas. Destas, 
        %quantAgendamentosEscolas% já realizaram agendamentos e %quantAgendamentosConcluidosEscolas% escolas já
        visitaram o Observatório Antares.<spam id=captionEscolasConcluidos>A tabela abaixo relaciona as 
          escolas que concluiram visitas ao Observatório e a quantidade de vezes o fizeram.</spam></p>
        <table id=EscolasConcluidos></table>
        <p style="text-indent: 42pt;"></p><spam id=captionEscolasCanceladas>A tabela abaixo relaciona as escolas 
          e a quantidade de vezes 
          que tiveram visitas canceladas.</spam>
        <table id=EscolasCanceladas></table>
        <p style="text-indent: 42pt;"></p><spam id=captionEscolasPendentes>A tabela abaixo relaciona as escolas que 
          possueem agendadas e ainda não concluídas ou aceitas.</spam>
        <table id=EscolasPendentes></table>

    </div>
  </div>


  <!-- Página Funcionarios -->
  <div class="Funcionarios"><div style="page-break-after: always"></div></div>
  <div class="Funcionarios">
    <div class="SectionTitulo">Análise dos dados referentes aos Funcionários</div>
    <div class="textSection">
      <p style="text-indent: 42pt;">O sistema possui registro de %quantFuncionarios% funcionários cadastradas. 
        <spam id=captionFuncionariosInativosText>Todavia, %quantFuncionariosDesligados% foram inativados no sistema
          não podendo exercer suas funções anteriores.</spam><spam id=captionFuncionariosAtivos>A tabela abaixo 
            relaciona os funcionários ativos no portal.</spam></p>
        <table id=funcionariosAtivos></table>
        <p style="text-indent: 42pt;"></p><spam id=captionFuncionariosInativos>A tabela abaixo relaciona os
          funcionários que foram inativados.</spam>
        <table id=funcionariosInativos></table>
    </div>
  </div>

  
  <!-- Página Visitas -->
  <div class="Visitas"><div style="page-break-after: always"></div></div>
  <div class="Visitas">
    <div class="SectionTitulo" >Análise dos dados referentes às Visitas</div>
    <div class="textSection">

    </div>
  </div>

</body>
</html>

<script>
  function generateTableHead(table, data) {
    var thead = table.createTHead();
    var row = thead.insertRow();
    for (key in data) {
      var th = document.createElement("th");
      var text = document.createTextNode(data[data.length- key-1]);
      th.appendChild(text);
      row.appendChild(th);
    }
  }

  function generateTable(table, data) {
    for (element in data) {
      var row = table.insertRow();
      for (key in data[element]) {
        var cell = row.insertCell();
        var text = document.createTextNode(data[element][key]);
        cell.appendChild(text);
      }
    }
  }
  
  var inicioPeriodo = "?";
  var fimPeriodo = "?";  
  var Agendamentos = 0;
  var Bolsistas = 0;
  var Escolas = 0;
  var Funcionarios = 0;
  var Visitas = 0;
  var tblAgendamentosCancelados = 0;
  var tblAgendamentosConfirmados = 0;
  var tblAgendamentosRealizados = 0;
  var tblAgendamentosPendentes = 0;
  var tblBolsistasAtivos = 0;
  var tblEscolasCanceladas = 0;
  var tblEscolasConcluidos = 0;
  var tblEscolasPendentes = 0;
  var tblFuncionariosAtivos = 0;
  var tblFuncionariosInativos = 0;
  //--------------------------------------------------------------------------
  if(!Agendamentos){
    els = document.getElementsByClassName("Agendamentos");
    for(i in els){
      els[i].innerHTML = "";
    }
  }else{
    if(tblAgendamentosCancelados!=0){
      var tabela = document.getElementById("AgendamentosCancelados");
      var data = Object.keys(tblAgendamentosCancelados[0]);
      generateTable(tabela, tblAgendamentosCancelados);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Agendamentos Cancelados no período entre <spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById("captionAgendamentosCancelados").innerHTML = '';
    }
    if(tblAgendamentosPendentes!=0){
      var tabela = document.getElementById("AgendamentosPendentes");
      var data = Object.keys(tblAgendamentosPendentes[0]);
      generateTable(tabela, tblAgendamentosPendentes);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Agendamentos Pendentes de confirmação no período entre <spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById("captionAgendamentosPendentes").innerHTML = '';
    }
    if(tblAgendamentosConfirmados!=0){
      var tabela = document.getElementById("AgendamentosConfirmados");
      var data = Object.keys(tblAgendamentosConfirmados[0]);
      generateTable(tabela, tblAgendamentosConfirmados);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Agendamentos Confirmados no período entre <spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById("captionAgendamentosConfirmados").innerHTML = '';
    }
    if(tblAgendamentosRealizados!=0){
      var tabela = document.getElementById("AgendamentosRealizados");
      var data = Object.keys(tblAgendamentosRealizados[0]);
      generateTable(tabela, tblAgendamentosRealizados);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Agendamentos Concluídos no período entre <spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo">.</spam>';
    }else{
      document.getElementById("captionAgendamentosRealizados").innerHTML = '';
    }

    
  }
  //------------------------------------------------------------------------------
  if(!Bolsistas){
    els = document.getElementsByClassName("Bolsistas");
    for(i in els){
      els[i].innerHTML = "";
    }
  }else{
    if(tblBolsistasAtivos!=0){
      var tabela = document.getElementById("BolsistasAtivos");
      var data = Object.keys(tblBolsistasAtivos[0]);
      generateTable(tabela, tblBolsistasAtivos);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Bolsistas ativos no período de <spam class="inicioPeriodo"></spam> a <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById("bolsistasAtivos").innerHTML = '';
    }
  }
  //------------------------------------------------------------------------------
  if(!Escolas){
    els = document.getElementsByClassName("Escolas");
    for(i in els){
      els[i].innerHTML = "";
    }
  }else{
    if(tblEscolasCanceladas){
      var tabela = document.getElementById("EscolasCanceladas");
      var data = Object.keys(tblEscolasCanceladas[0]);
      generateTable(tabela, tblEscolasCanceladas);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Escolas que tiveram visitas canceladas no período de <spam class="inicioPeriodo"></spam> a <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById('EscolasCanceladas').innerHTML = '';
    }
    if(tblEscolasConcluidos){
      var tabela = document.getElementById("EscolasConcluidos");
      var data = Object.keys(tblEscolasConcluidos[0]);
      generateTable(tabela, tblEscolasConcluidos);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Escolas que concluiram visitas no período de <spam class="inicioPeriodo"></spam> a <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById('EscolasCanceladas').innerHTML = '';
    }
    if(tblEscolasPendentes){
      var tabela = document.getElementById("EscolasPendentes");
      var data = Object.keys(tblEscolasPendentes[0]);
      generateTable(tabela, tblEscolasPendentes);
      generateTableHead(tabela, data);
      tabela.createCaption().innerHTML = 'Escolas que possuem agendamentos não concluídos no período de <spam class="inicioPeriodo"></spam> a <spam class="fimPeriodo"></spam>';
    }else{
      document.getElementById('EscolasPendentes').innerHTML = '';
    }
  }
  //------------------------------------------------------------------------------
  if(!Funcionarios){
    els = document.getElementsByClassName("Funcionarios");
    for(i in els){
      els[i].innerHTML = "";
    }
  }else{
    if(tblFuncionariosAtivos){
        var tabela = document.getElementById("funcionariosAtivos");
        var data = Object.keys(tblFuncionariosAtivos[0]);
        generateTable(tabela, tblFuncionariosAtivos);
        generateTableHead(tabela, data);
        tabela.createCaption().innerHTML = 'Funcionários que estão ativos no período entre<spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo"></spam>';
      }else{
        document.getElementById('funcionariosAtivos').innerHTML = '';
      }
      if(tblFuncionariosInativos){
        var tabela = document.getElementById("funcionariosInativos");
        var data = Object.keys(tblFuncionariosInativos[0]);
        generateTable(tabela, tblFuncionariosInativos);
        generateTableHead(tabela, data);
        tabela.createCaption().innerHTML = 'Funcionários que estão inativos no período entre<spam class="inicioPeriodo"></spam> e <spam class="fimPeriodo"></spam>';
      }else{
        document.getElementById('captionFuncionariosInativosText').innerHTML = '';
        document.getElementById('funcionariosInativosText').innerHTML = '';
      }
  }
  //------------------------------------------------------------------------------
  if(!Visitas){
    els = document.getElementsByClassName("Visitas");
    for(i in els){
      els[i].innerHTML = "";
    }
  }

  els = document.getElementsByClassName("inicioPeriodo");
  for(i in els){
      els[i].innerHTML = inicioPeriodo;
  }
  els = document.getElementsByClassName("fimPeriodo");
  for(i in els){
    els[i].innerHTML = fimPeriodo;
  }
</script>
